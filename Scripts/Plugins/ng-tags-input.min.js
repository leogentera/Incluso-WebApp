(function(){"use strict";var n={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,comma:188},t=angular.module("ngTagsInput",[]);t.directive("tagsInput",["$timeout","$document","tagsInputConfig",function(t,i,r){function u(){var n={};return{on:function(t,i){n[t]||(n[t]=[]),n[t].push(i)},trigger:function(t,i){angular.forEach(n[t],function(n){n.call(null,i)})}}}return{restrict:"E",scope:{tags:"=ngModel",onTagAdded:"&",onTagRemoved:"&"},replace:!0,transclude:!0,templateUrl:"ngTagsInput/tags-input.html",controller:["$scope","$attrs","$element",function(n,t,i){var f=new u,e;r.load(n,t,{customClass:{type:String,defaultValue:""},placeholder:{type:String,defaultValue:"Add a tag"},tabindex:{type:Number},removeTagSymbol:{type:String,defaultValue:String.fromCharCode(215)},replaceSpacesWithDashes:{type:Boolean,defaultValue:!0},minLength:{type:Number,defaultValue:3},maxLength:{type:Number},addOnEnter:{type:Boolean,defaultValue:!0},addOnSpace:{type:Boolean,defaultValue:!1},addOnComma:{type:Boolean,defaultValue:!0},addOnBlur:{type:Boolean,defaultValue:!0},allowedTagsPattern:{type:RegExp,defaultValue:/^[a-zA-Z0-9\s]+$/},enableEditingLastTag:{type:Boolean,defaultValue:!1}});f.on("tag-added",n.onTagAdded);f.on("tag-removed",n.onTagRemoved);n.newTag="",n.tags=n.tags||[],n.tryAdd=function(){var i=!1,t=n.newTag;return t.length>=n.options.minLength&&n.options.allowedTagsPattern.test(t)&&(n.options.replaceSpacesWithDashes&&(t=t.replace(/\s/g,"-")),n.tags.indexOf(t)===-1&&(n.tags.push(t),f.trigger("tag-added",{$tag:t})),n.newTag="",f.trigger("input-changed",""),i=!0),i},n.tryRemoveLast=function(){var t=!1;return n.tags.length>0&&(n.options.enableEditingLastTag?n.newTag=n.remove(n.tags.length-1):e?(n.remove(n.tags.length-1),e=!1):e=!0,t=!0),t},n.remove=function(t){var i=n.tags.splice(t,1)[0];return f.trigger("tag-removed",{$tag:i}),i},n.getCssClass=function(t){var i=t===n.tags.length-1;return e&&i?"selected":""},n.$watch(function(){return n.newTag.length>0},function(){e=!1}),this.registerAutocomplete=function(){var t=i.find("input");t.on("keydown",function(n){f.trigger("input-keydown",n)});return n.newTagChange=function(){f.trigger("input-changed",n.newTag)},{tryAddTag:function(t){return n.newTag=t,n.tryAdd()},focusInput:function(){t[0].focus()},getTags:function(){return n.tags},on:function(n,t){f.on(n,t);return this}}}}],link:function(r,u){var e=[n.enter,n.comma,n.space,n.backspace],f=u.find("input");f.on("keydown",function(t){if(!t.isImmediatePropagationStopped||!t.isImmediatePropagationStopped()){var i=t.keyCode,u=t.shiftKey||t.altKey||t.ctrlKey||t.metaKey;u||e.indexOf(i)===-1||(i===n.enter&&r.options.addOnEnter||i===n.comma&&r.options.addOnComma||i===n.space&&r.options.addOnSpace?(r.tryAdd()&&r.$apply(),t.preventDefault()):i===n.backspace&&this.value.length===0&&r.tryRemoveLast()&&(r.$apply(),t.preventDefault()))}}).on("focus",function(){r.hasFocus||(r.hasFocus=!0,r.$apply())}).on("blur",function(){t(function(){var n=angular.element(i[0].activeElement).parent();n[0]!==u[0]&&(r.hasFocus=!1,r.options.addOnBlur&&r.tryAdd(),r.$apply())},0,!1)});u.find("div").on("click",function(){f[0].focus()})}}}]),t.directive("autoComplete",["$document","$timeout","$sce","tagsInputConfig",function(t,i,r,u){function f(n,t){var r={},u,e,f;return e=function(n,t){var i=[];return n.forEach(function(n){t.indexOf(n)===-1&&i.push(n)}),i},r.reset=function(){f=null,r.items=[],r.visible=!1,r.index=-1,r.selected=null,r.query=null,i.cancel(u)},r.show=function(){r.selected=null,r.visible=!0},r.hide=function(){r.visible=!1},r.load=function(o,s){if(o.length<t.minLength){r.reset();return}i.cancel(u),u=i(function(){r.query=o;var t=n({$query:o});f=t,t.then(function(n){t===f&&(r.items=e(n,s),r.items.length>0&&r.show())})},t.debounceDelay,!1)},r.selectNext=function(){r.select(++r.index)},r.selectPrior=function(){r.select(--r.index)},r.select=function(n){n<0?n=r.items.length-1:n>=r.items.length&&(n=0),r.index=n,r.selected=r.items[n]},r.reset(),r}function e(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return{restrict:"E",require:"?^tagsInput",scope:{source:"&"},templateUrl:"ngTagsInput/auto-complete.html",link:function(i,o,s,h){var v=[n.enter,n.tab,n.escape,n.up,n.down],c,l,a;u.load(i,s,{debounceDelay:{type:Number,defaultValue:100},minLength:{type:Number,defaultValue:3},highlightMatchedText:{type:Boolean,defaultValue:!0},maxResultsToShow:{type:Number,defaultValue:10}}),l=h.registerAutocomplete(),c=new f(i.source,i.options),a=i.options.highlightMatchedText?function(n,t){var i=new RegExp(t,"gi");return n.replace(i,"**$&**")}:function(n){return n},i.suggestionList=c,i.addSuggestion=function(){var n=!1;return c.selected&&(l.tryAddTag(c.selected),c.reset(),l.focusInput(),n=!0),n},i.highlight=function(n){return n=a(n,c.query),n=e(n),n=n.replace(/\*\*(.+?)\*\*/g,"<em>$1<\/em>"),r.trustAsHtml(n)};l.on("input-changed",function(n){n?c.load(n,l.getTags()):c.reset()}).on("input-keydown",function(t){var r,u,f;v.indexOf(t.keyCode)!==-1&&(f=!1,t.stopImmediatePropagation=function(){f=!0,t.stopPropagation()},t.isImmediatePropagationStopped=function(){return f},c.visible&&(r=t.keyCode,u=!1,r===n.down?(c.selectNext(),u=!0):r===n.up?(c.selectPrior(),u=!0):r===n.escape?(c.reset(),u=!0):(r===n.enter||r===n.tab)&&(u=i.addSuggestion()),u&&(t.preventDefault(),t.stopImmediatePropagation(),i.$apply())))});t.on("click",function(){c.visible&&(c.reset(),i.$apply())})}}}]),t.directive("transcludeAppend",function(){return function(n,t,i,r,u){u&&u(function(n){t.append(n)})}}),t.service("tagsInputConfig",["$interpolate",function(n){this.load=function(t,i,r){var u={};u[String]=function(n){return n},u[Number]=function(n){return parseInt(n,10)},u[Boolean]=function(n){return n==="true"},u[RegExp]=function(n){return new RegExp(n)},t.options={},angular.forEach(r,function(f,e){var o=i[e]&&n(i[e])(t.$parent),s=u[r[e].type];t.options[e]=o?s(o):r[e].defaultValue})}}]),t.run(["$templateCache",function(n){n.put("ngTagsInput/tags-input.html",'<div class="ngTagsInput" tabindex="-1" ng-class="options.customClass" transclude-append=""><div class="tags" ng-class="{focused: hasFocus}"><ul><li ng-repeat="tag in tags" ng-class="getCssClass($index)"><span>{{tag}}<\/span> <button type="button" ng-click="remove($index)">{{options.removeTagSymbol}}<\/button><\/li><\/ul><input placeholder="{{options.placeholder}}" size="{{options.placeholder.length}}" maxlength="{{options.maxLength}}" tabindex="{{options.tabindex}}" ng-model="newTag" ng-change="newTagChange()"><\/div><\/div>'),n.put("ngTagsInput/auto-complete.html",'<div class="autocomplete" ng-show="suggestionList.visible"><ul><li ng-repeat="item in suggestionList.items | limitTo:options.maxResultsToShow" ng-class="{selected: item == suggestionList.selected}" ng-click="addSuggestion()" ng-mouseenter="suggestionList.select($index)" ng-bind-html="highlight(item)"><\/li><\/ul><\/div>')}])})();
//# sourceMappingURL=ng-tags-input.min.js.map